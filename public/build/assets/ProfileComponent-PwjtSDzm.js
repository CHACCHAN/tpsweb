import{r as h,e as S,o,c as d,a as e,j as p,v as C,x as D,t as x,F as k,b as N,_ as O,u as j,f as Z,g as B,h as A,w as P,k as H,l as $,i as I,p as V,d as F}from"./app-rPuQw5Ku.js";import{a as M}from"./js.cookie-Hg5VKEPt.js";import{C as R}from"./cropper-mdygAauV.js";const E={key:0,class:"text-center"},U=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-envelope-exclamation-fill",viewBox:"0 0 16 16"},[e("path",{d:"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.026A2 2 0 0 0 2 14h6.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586l-1.239-.757ZM16 4.697v4.974A4.491 4.491 0 0 0 12.5 8a4.49 4.49 0 0 0-1.965.45l-.338-.207L16 4.697Z"}),e("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1.5a.5.5 0 0 1-1 0V11a.5.5 0 0 1 1 0Zm0 3a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z"})],-1),z=e("div",{class:"fs-5 fw-bold"},"メールアドレスを変更する前に認証が必要です",-1),q={key:1,class:"text-center"},J=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-envelope-at-fill",viewBox:"0 0 16 16"},[e("path",{d:"M2 2A2 2 0 0 0 .05 3.555L8 8.414l7.95-4.859A2 2 0 0 0 14 2H2Zm-2 9.8V4.698l5.803 3.546L0 11.801Zm6.761-2.97-6.57 4.026A2 2 0 0 0 2 14h6.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586l-1.239-.757ZM16 9.671V4.697l-5.803 3.546.338.208A4.482 4.482 0 0 1 12.5 8c1.414 0 2.675.652 3.5 1.671Z"}),e("path",{d:"M15.834 12.244c0 1.168-.577 2.025-1.587 2.025-.503 0-1.002-.228-1.12-.648h-.043c-.118.416-.543.643-1.015.643-.77 0-1.259-.542-1.259-1.434v-.529c0-.844.481-1.4 1.26-1.4.585 0 .87.333.953.63h.03v-.568h.905v2.19c0 .272.18.42.411.42.315 0 .639-.415.639-1.39v-.118c0-1.277-.95-2.326-2.484-2.326h-.04c-1.582 0-2.64 1.067-2.64 2.724v.157c0 1.867 1.237 2.654 2.57 2.654h.045c.507 0 .935-.07 1.18-.18v.731c-.219.1-.643.175-1.237.175h-.044C10.438 16 9 14.82 9 12.646v-.214C9 10.36 10.421 9 12.485 9h.035c2.12 0 3.314 1.43 3.314 3.034v.21Zm-4.04.21v.227c0 .586.227.8.581.8.31 0 .564-.17.564-.743v-.367c0-.516-.275-.708-.572-.708-.346 0-.573.245-.573.791Z"})],-1),K=e("div",{class:"fs-5 fw-bold"},"認証コードを入力してください",-1),X={key:0,class:"form-text text-start text-danger"},G={key:2,class:"text-start"},Q=e("div",{class:"text-secondary"},"現在のメールアドレス",-1),W={class:"fw-bold"},Y=e("br",null,null,-1),ee=e("div",{class:"text-secondary"},"新しいメールアドレス",-1),te={key:0,class:"form-text text-start text-danger"},se={class:"text-end mt-3"},ae=["disabled"],ne={key:3,class:"text-center"},oe=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-envelope-check-fill",viewBox:"0 0 16 16"},[e("path",{d:"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.026A2 2 0 0 0 2 14h6.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586l-1.239-.757ZM16 4.697v4.974A4.491 4.491 0 0 0 12.5 8a4.49 4.49 0 0 0-1.965.45l-.338-.207L16 4.697Z"}),e("path",{d:"M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Zm-1.993-1.679a.5.5 0 0 0-.686.172l-1.17 1.95-.547-.547a.5.5 0 0 0-.708.708l.774.773a.75.75 0 0 0 1.174-.144l1.335-2.226a.5.5 0 0 0-.172-.686Z"})],-1),le=e("div",{class:"fs-5 fw-bold"},"正常に更新されました",-1),ie=[oe,le],re={__name:"MailAddressComponent",props:{email:String},emits:["getLoginData"],setup(b,{emit:w}){const c=b,v=w,i=h(null),l=h(null),n=h([{flag:!0},{flag:!1},{flag:!1},{flag:!1}]),g=h(!1),f=h(null);S(()=>{M.get("one_time_flag")&&(n.value[0].flag=!1,n.value[1].flag=!1,n.value[2].flag=!0)});const a=t=>{i.value=Math.floor(Math.random()*9e5)+1e5;const r=t.target.innerHTML;t.target.disabled=!0,t.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   処理中',fetch("/tps-site/auth/mailcheck",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({email:c.email,subject:"認証メール",onetime_token:i.value})}).then(u=>u.json()).then(u=>{u.responseData?(t.target.innerHTML=r,t.target.disabled=!1,n.value[0].flag=!1,n.value[1].flag=!0):window.location.reload(!0)}).catch(u=>{console.log(u)})},s=t=>{const r=t.target.innerHTML;t.target.disabled=!0,t.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   確認中',i.value===l.value?(n.value[1].flag=!1,n.value[2].flag=!0,g.value=!1,u(),M.get("one_time_flag")||M.set("one_time_flag",!0)):(g.value=!0,u());function u(){t.target.innerHTML=r,t.target.disabled=!1}},m=t=>{const r=t.target.innerHTML,u=f.value;t.target.disabled=!0,t.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   送信中',fetch("/tps-site/auth/change/mailaddress",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({email:u})}).then(y=>y.json()).then(y=>{y.responseData&&y.checkMail?(_(),n.value[2].flag=!1,n.value[3].flag=!0,g.value=!1,v("getLoginData")):y.responseData&&!y.checkMail?(_(),g.value=!0):window.location.reload(!0)}).catch(y=>{console.log(y)});function _(){t.target.innerHTML=r,t.target.disabled=!1}};return(t,r)=>(o(),d(k,null,[n.value[0].flag?(o(),d("div",E,[U,z,e("button",{type:"button",class:"btn btn-primary rounded-pill py-1 text-light mt-3",onClick:a},"認証する")])):p("",!0),n.value[1].flag?(o(),d("div",q,[J,K,C(e("input",{type:"number","onUpdate:modelValue":r[0]||(r[0]=u=>l.value=u),class:"form-control rounded-pill border-success border-2 mt-3"},null,512),[[D,l.value]]),g.value?(o(),d("div",X,"認証コードが一致しませんでした")):p("",!0),e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-success rounded-pill py-1 text-light mt-3",onClick:s},"確認")])])):p("",!0),n.value[2].flag?(o(),d("div",G,[Q,e("div",W,x(c.email),1),Y,ee,C(e("input",{type:"email","onUpdate:modelValue":r[1]||(r[1]=u=>f.value=u),class:"form-control rounded-pill"},null,512),[[D,f.value]]),g.value?(o(),d("div",te,"存在するメールアドレスは使用できません")):p("",!0),e("div",se,[e("button",{type:"button",class:"btn btn-success rounded-pill py-1 text-light",onClick:m,disabled:!f.value},"変更",8,ae)])])):p("",!0),n.value[3].flag?(o(),d("div",ne,ie)):p("",!0)],64))}},ce={key:0,class:"text-center"},de=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-shield-fill-x",viewBox:"0 0 16 16"},[e("path",{d:"M8 0c-.69 0-1.843.265-2.928.56-1.11.3-2.229.655-2.887.87a1.54 1.54 0 0 0-1.044 1.262c-.596 4.477.787 7.795 2.465 9.99a11.777 11.777 0 0 0 2.517 2.453c.386.273.744.482 1.048.625.28.132.581.24.829.24s.548-.108.829-.24a7.159 7.159 0 0 0 1.048-.625 11.775 11.775 0 0 0 2.517-2.453c1.678-2.195 3.061-5.513 2.465-9.99a1.541 1.541 0 0 0-1.044-1.263 62.467 62.467 0 0 0-2.887-.87C9.843.266 8.69 0 8 0zM6.854 5.146 8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 1 1 .708-.708z"})],-1),ue=e("div",{class:"fs-5 fw-bold"},"パスワードを変更する前に認証が必要です",-1),me={key:1,class:"text-center"},pe=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-shield-fill-plus",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M8 0c-.69 0-1.843.265-2.928.56-1.11.3-2.229.655-2.887.87a1.54 1.54 0 0 0-1.044 1.262c-.596 4.477.787 7.795 2.465 9.99a11.777 11.777 0 0 0 2.517 2.453c.386.273.744.482 1.048.625.28.132.581.24.829.24s.548-.108.829-.24a7.159 7.159 0 0 0 1.048-.625 11.775 11.775 0 0 0 2.517-2.453c1.678-2.195 3.061-5.513 2.465-9.99a1.541 1.541 0 0 0-1.044-1.263 62.467 62.467 0 0 0-2.887-.87C9.843.266 8.69 0 8 0zm-.5 5a.5.5 0 0 1 1 0v1.5H10a.5.5 0 0 1 0 1H8.5V9a.5.5 0 0 1-1 0V7.5H6a.5.5 0 0 1 0-1h1.5V5z"})],-1),he=e("div",{class:"fs-5 fw-bold"},"認証コードを入力してください",-1),ge={key:0,class:"form-text text-start text-danger"},ve={key:2,class:"text-start"},fe=e("div",{class:"text-secondary"},"新しいパスワード",-1),_e={class:"text-end mt-3"},be=["disabled"],we={key:3,class:"text-center"},ye=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-shield-fill-check",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M8 0c-.69 0-1.843.265-2.928.56-1.11.3-2.229.655-2.887.87a1.54 1.54 0 0 0-1.044 1.262c-.596 4.477.787 7.795 2.465 9.99a11.777 11.777 0 0 0 2.517 2.453c.386.273.744.482 1.048.625.28.132.581.24.829.24s.548-.108.829-.24a7.159 7.159 0 0 0 1.048-.625 11.775 11.775 0 0 0 2.517-2.453c1.678-2.195 3.061-5.513 2.465-9.99a1.541 1.541 0 0 0-1.044-1.263 62.467 62.467 0 0 0-2.887-.87C9.843.266 8.69 0 8 0zm2.146 5.146a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647z"})],-1),xe=e("div",{class:"fs-5 fw-bold"},"正常に更新されました",-1),ke=[ye,xe],Me={__name:"PasswordComponent",props:{email:String},emits:["getLoginData"],setup(b,{emit:w}){const c=b,v=w,i=h(null),l=h(null),n=h([{flag:!0},{flag:!1},{flag:!1},{flag:!1}]),g=h(!1),f=h(null);S(()=>{M.get("one_time_flag")&&(n.value[0].flag=!1,n.value[1].flag=!1,n.value[2].flag=!0)});const a=r=>{i.value=Math.floor(Math.random()*9e5)+1e5;const u=r.target.innerHTML;r.target.disabled=!0,r.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   処理中',fetch("/tps-site/auth/mailcheck",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({email:c.email,subject:"認証メール",onetime_token:i.value})}).then(_=>_.json()).then(_=>{_.responseData?(r.target.innerHTML=u,r.target.disabled=!1,n.value[0].flag=!1,n.value[1].flag=!0):window.location.reload(!0)}).catch(_=>{console.log(_)})},s=r=>{const u=r.target.innerHTML;r.target.disabled=!0,r.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   確認中',i.value===l.value?(n.value[1].flag=!1,n.value[2].flag=!0,g.value=!1,_(),M.get("one_time_flag")||M.set("one_time_flag",!0)):(g.value=!0,_());function _(){r.target.innerHTML=u,r.target.disabled=!1}},m=r=>{const u=r.target.innerHTML,_=f.value;r.target.disabled=!0,r.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   送信中',fetch("/tps-site/auth/change/password",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({password:_})}).then(T=>T.json()).then(T=>{T.responseData?(y(),n.value[2].flag=!1,n.value[3].flag=!0,g.value=!1,v("getLoginData")):window.location.reload(!0)}).catch(T=>{console.log(T)});function y(){r.target.innerHTML=u,r.target.disabled=!1}},t=r=>{const u=document.getElementById("newPassword");u.type==="password"?(u.type="text",r.target.innerHTML="パスワードを非表示"):(u.type="password",r.target.innerHTML="パスワードを表示")};return(r,u)=>(o(),d(k,null,[n.value[0].flag?(o(),d("div",ce,[de,ue,e("button",{type:"button",class:"btn btn-primary rounded-pill py-1 text-light mt-3",onClick:a},"認証する")])):p("",!0),n.value[1].flag?(o(),d("div",me,[pe,he,C(e("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=_=>l.value=_),class:"form-control rounded-pill border-success border-2 mt-3"},null,512),[[D,l.value]]),g.value?(o(),d("div",ge,"認証コードが一致しませんでした")):p("",!0),e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-success rounded-pill py-1 text-light mt-3",onClick:s},"確認")])])):p("",!0),n.value[2].flag?(o(),d("div",ve,[fe,C(e("input",{type:"password","onUpdate:modelValue":u[1]||(u[1]=_=>f.value=_),id:"newPassword",class:"form-control rounded-pill"},null,512),[[D,f.value]]),e("button",{type:"button",class:"btn btn-light border-0 mt-1 p-1",onClick:t},"パスワードを表示"),e("div",_e,[e("button",{type:"button",class:"btn btn-success rounded-pill py-1 text-light",onClick:m,disabled:!f.value},"変更",8,be)])])):p("",!0),n.value[3].flag?(o(),d("div",we,ke)):p("",!0)],64))}},Le={class:"p-3"},Te={class:"form-floating mb-3"},$e=["value"],Ce=e("label",{for:"inputFirstName"},"姓",-1),De={class:"form-floating mb-3"},Se=["value"],He=e("label",{for:"inputLastName"},"名",-1),Ne={class:"form-floating"},Oe=["value"],je=e("label",{for:"inputName"},"ニックネーム",-1),Ze={__name:"NamesComponent",props:{userData:Object},emits:["getLoginData"],setup(b,{emit:w}){const c=b,v=w,i=l=>{let n=c.userData.id,g=c.userData.first_name,f=c.userData.last_name,a=c.userData.name,s=c.userData.email;l.target.id==="inputFirstName"?(g=l.target.value,m()):l.target.id==="inputLastName"?(f=l.target.value,m()):l.target.id==="inputName"&&(a=l.target.value,m());function m(){fetch("/tps-site/auth/update",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({id:n,first_name:g,last_name:f,name:a,email:s})}).then(t=>t.json()).then(t=>{v("getLoginData")}).catch(t=>{console.log(t)})}};return(l,n)=>(o(),d("div",Le,[e("div",Te,[e("input",{type:"text",value:c.userData.first_name,onChange:i,class:"form-control rounded-pill fw-bold",id:"inputFirstName",placeholder:""},null,40,$e),Ce]),e("div",De,[e("input",{type:"text",value:c.userData.last_name,onChange:i,class:"form-control rounded-pill fw-bold",id:"inputLastName",placeholder:""},null,40,Se),He]),e("div",Ne,[e("input",{type:"text",value:c.userData.name,onChange:i,class:"form-control rounded-pill fw-bold",id:"inputName",placeholder:""},null,40,Oe),je])]))}},Be={key:0},Ae={for:"inputCropperImage",class:"position-relative w-100",style:{cursor:"pointer"}},Pe=["src"],Ie=e("div",{class:"position-absolute w-100 h-100 d-flex align-items-center justify-content-center text-light top-0",style:{"text-shadow":"0 0 10px black"}}," クリックで画像追加 ",-1),Ve={key:1},Fe=["src"],Re={key:2,class:"text-end mx-3 my-1"},Ee={__name:"AvatarComponent",emits:["getLoginData"],setup(b,{emit:w}){const c=w,v=h(null),i=h({aspectRatio:1/1}),l=h(null),n=h(null),g=a=>{new Promise((s,m)=>{const t=new FileReader;t.readAsDataURL(a.target.files[0]),t.onload=()=>{l.value=t.result,s()}}).then(()=>{v.value=new R(n.value,i.value)})},f=a=>{const s=a.target.innerHTML,m=v.value.getCroppedCanvas();a.target.disabled=!0,a.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   送信中',fetch("/tps-site/auth/change/avatar",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,enctype:"multipart/form-data","Content-Type":"application/json"},body:JSON.stringify({image:m.toDataURL()})}).then(t=>t.json()).then(t=>{a.target.disabled=s,a.target.disabled=!1,v.value.destroy(),l.value=null,c("getLoginData")}).catch(t=>{console.log(t)})};return(a,s)=>(o(),d(k,null,[l.value?(o(),d("div",Ve,[e("img",{ref_key:"cropperImage",ref:n,src:l.value,class:"w-100 z-3"},null,8,Fe)])):(o(),d("div",Be,[e("label",Ae,[e("img",{src:"/tps-site/images/components/IconImage.png",class:"w-100"},null,8,Pe),Ie]),e("input",{type:"file",id:"inputCropperImage",class:"d-none",onChange:g,accept:"image/png, image/jpeg"},null,32)])),l.value?(o(),d("div",Re,[e("button",{type:"button",class:"btn btn-danger rounded-pill text-light",onClick:s[0]||(s[0]=m=>(l.value=null,v.value.destroy()))},"リセット"),e("button",{type:"button",class:"btn btn-success rounded-pill text-light ms-2",onClick:f},"送信")])):p("",!0)],64))}},Ue={key:0,class:"text-center"},ze=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-person-fill-exclamation",viewBox:"0 0 16 16"},[e("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm-9 8c0 1 1 1 1 1h5.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.544-3.393C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4Z"}),e("path",{d:"M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Zm-3.5-2a.5.5 0 0 0-.5.5v1.5a.5.5 0 0 0 1 0V11a.5.5 0 0 0-.5-.5Zm0 4a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1Z"})],-1),qe=e("div",{class:"fs-5 fw-bold"},"アカウント削除の前に認証が必要です",-1),Je={key:1,class:"text-center"},Ke=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-person-fill-add",viewBox:"0 0 16 16"},[e("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),e("path",{d:"M2 13c0 1 1 1 1 1h5.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.544-3.393C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4Z"})],-1),Xe=e("div",{class:"fs-5 fw-bold"},"認証コードを入力してください",-1),Ge={key:0,class:"form-text text-start text-danger"},Qe={key:2,class:"text-center"},We=N('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor" class="bi bi-person-fill-x" viewBox="0 0 16 16"><path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm-9 8c0 1 1 1 1 1h5.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.544-3.393C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4Z"></path><path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708Z"></path></svg><div class="fs-5 fw-bold mb-3">アカウントを本当に削除しますか?</div><div class="text-secondary text-start"> アカウントを削除すると、ゲスト以外のサービス全般が利用不可になります。 また、アカウントを復元することは一切できません。 </div>',3),Ye={__name:"DeleteComponent",props:{userLoginData:Object},setup(b){const w=b,c=h(null),v=h(null),i=h([{flag:!0},{flag:!1},{flag:!1}]),l=h(!1),n=a=>{c.value=Math.floor(Math.random()*9e5)+1e5;const s=a.target.innerHTML;a.target.disabled=!0,a.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   処理中',fetch("/tps-site/auth/mailcheck",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({email:w.userLoginData.email,subject:"認証メール",onetime_token:c.value})}).then(m=>m.json()).then(m=>{m.responseData?(a.target.innerHTML=s,a.target.disabled=!1,i.value[0].flag=!1,i.value[1].flag=!0):window.location.reload(!0)}).catch(m=>{console.log(m)})},g=a=>{const s=a.target.innerHTML;a.target.disabled=!0,a.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   確認中',c.value===v.value?(i.value[1].flag=!1,i.value[2].flag=!0,l.value=!1,m()):(l.value=!0,m());function m(){a.target.innerHTML=s,a.target.disabled=!1}},f=a=>{a.target.disabled=!0,a.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>   処理中',fetch("/tps-site/auth/delete",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({id:w.userLoginData.id})}).then(s=>s.json()).then(s=>{window.location.reload(!0)}).catch(s=>{console.log(s)})};return(a,s)=>(o(),d(k,null,[i.value[0].flag?(o(),d("div",Ue,[ze,qe,e("button",{type:"button",class:"btn btn-primary rounded-pill py-1 text-light mt-3",onClick:n},"認証する")])):p("",!0),i.value[1].flag?(o(),d("div",Je,[Ke,Xe,C(e("input",{type:"number","onUpdate:modelValue":s[0]||(s[0]=m=>v.value=m),class:"form-control rounded-pill border-success border-2 mt-3"},null,512),[[D,v.value]]),l.value?(o(),d("div",Ge,"認証コードが一致しませんでした")):p("",!0),e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-success rounded-pill py-1 text-light mt-3",onClick:g},"確認")])])):p("",!0),i.value[2].flag?(o(),d("div",Qe,[We,e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-danger rounded-pill py-1 text-light",onClick:f},"アカウント削除")])])):p("",!0)],64))}},L=b=>(V("data-v-132ec8e1"),b=b(),F(),b),et={key:0,class:"container"},tt={class:"card card-body text-bg-dark border-0 mt-3"},st={class:"d-flex align-items-center justify-content-start mb-3"},at=L(()=>e("div",{class:"vr mx-1"},null,-1)),nt=L(()=>e("a",{href:"/tps-site/auth/logout",id:"clickItem",class:"text-decoration-none text-light p-2 py-1 rounded-pill"},"ログアウト",-1)),ot={class:"row"},lt={class:"col-12 mb-3"},it={class:"d-flex align-items-center justify-content-center"},rt=["src"],ct=["src"],dt={class:"d-flex align-items-center justify-content-center fs-2"},ut={class:"col-12"},mt=L(()=>e("div",{class:"h4"},"基本情報",-1)),pt={class:"list-group w-100"},ht=["onClick"],gt={class:"row text-dark"},vt={class:"col-4 col-md-2"},ft={class:"fw-bold text-start"},_t={class:"col-7 col-md-9"},bt={class:"text-secondary text-truncate"},wt=["innerHTML"],yt=L(()=>e("hr",null,null,-1)),xt=L(()=>e("div",{class:"col-12"},[e("div",{class:"h4"},"セキュリティ")],-1)),kt={class:"card card-body pb-0"},Mt={class:"row"},Lt={class:"col-9 text-dark"},Tt={class:"h5"},$t={class:"text-secondary"},Ct={class:"col-3"},Dt=["src"],St={class:"col-12"},Ht={class:"border-top mt-3 py-2"},Nt=["onClick"],Ot={class:"modal",id:"viewInfomationModal",tabindex:"-1","aria-hidden":"true"},jt={class:"modal-dialog modal-dialog-centered"},Zt={class:"modal-content"},Bt={class:"modal-body p-0"},At=L(()=>e("div",{class:"text-center fs-3 fw-bold"},"INFOMATION",-1)),Pt={class:"modal",id:"viewSettingModal",tabindex:"-1","aria-hidden":"true"},It={class:"modal-dialog modal-dialog-centered"},Vt={class:"modal-content"},Ft={class:"modal-body pt-0"},Rt=L(()=>e("div",{class:"text-center fs-3 fw-bold"}," TPS ACCOUNT ",-1)),Et={__name:"ProfileComponent",setup(b){const w=j(),c=h(null),v=h(`
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-caret-right" viewBox="0 0 16 16">
            <path d="M6 12.796V3.204L11.481 8 6 12.796zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"/>
        </svg>
    `),i=h([{id:1,flag:!1,title:"アバター",comment:"アバターを設定する",icon:v.value},{id:2,flag:!1,title:"姓",comment:null,icon:v.value},{id:3,flag:!1,title:"名",comment:null,icon:v.value},{id:4,flag:!1,title:"ニックネーム",comment:null,icon:v.value}]),l=h([{id:1,flag:!1,title:"メールアドレス",comment:"TPSアカウントのメールアドレスを変更します。",name:"メールアドレスを変更する",image:"/tps-site/images/components/MailAddress.jpg"},{id:2,flag:!1,title:"パスワード",comment:"TPSアカウントのパスワードを変更します。",name:"パスワードを変更する",image:"/tps-site/images/components/Password.jpg"},{id:3,flag:!1,title:"アカウント削除",comment:"TPSアカウントを削除します。",name:"手続きをする",image:"/tps-site/images/components/AccountDelete.jpg"}]);S(()=>{document.title="プロフィール",n()}),Z(()=>{M.remove("one_time_flag")});const n=()=>{c.value=new Array,fetch("/tps-site/auth/login/check").then(a=>a.json()).then(a=>{a.ResponseData?(c.value=a.UserData,i.value[1].comment=c.value.first_name,i.value[2].comment=c.value.last_name,i.value[3].comment=c.value.name):w.push({name:"home"})}).catch(a=>{console.log(a)})},g=a=>{for(let s=0;s<l.value.length;s++)l.value[s].id===a?l.value[s].flag=!0:l.value[s].flag=!1},f=a=>{for(let s=0;s<i.value.length;s++)i.value[s].id===a?i.value[s].flag=!0:i.value[s].flag=!1};return(a,s)=>{const m=B("router-link");return o(),d(k,null,[c.value?(o(),d("div",et,[e("div",tt,[e("div",st,[A(m,{to:{name:"home"},id:"clickItem",class:"text-decoration-none text-light p-2 py-1 rounded-pill"},{default:P(()=>[I("ホーム")]),_:1}),at,nt]),e("div",ot,[e("div",lt,[e("div",it,[c.value.avatar?(o(),d("img",{key:0,src:"/tps-site/storage/user/avatar/"+c.value.avatar,class:"rounded-circle shadow",width:"150px"},null,8,rt)):(o(),d("img",{key:1,src:"/tps-site/images/components/IconImage.png",class:"rounded-circle shadow",width:"150px"},null,8,ct))]),e("div",dt," ようこそ、"+x(c.value.name)+"さん ",1)]),e("div",ut,[mt,e("div",pt,[(o(!0),d(k,null,H(i.value,t=>(o(),d("button",{type:"button",class:"list-group-item list-group-item-action","data-bs-toggle":"modal","data-bs-target":"#viewInfomationModal",key:t,onClick:r=>f(t.id)},[e("div",gt,[e("div",vt,[e("div",ft,x(t.title),1)]),e("div",_t,[e("div",bt,x(t.comment),1)]),e("div",{class:"col-1 text-end ps-2",innerHTML:t.icon},null,8,wt)])],8,ht))),128))]),yt]),xt,(o(!0),d(k,null,H(l.value,t=>(o(),d("div",{class:"col-12 col-md-6 mb-5",key:t.id},[e("div",kt,[e("div",Mt,[e("div",Lt,[e("div",Tt,x(t.title),1),e("div",$t,x(t.comment),1)]),e("div",Ct,[e("img",{src:t.image,class:"rounded-5 shadow border w-100"},null,8,Dt)]),e("div",St,[e("div",Ht,[e("div",{class:"text-primary",style:{cursor:"pointer"},onClick:r=>g(t.id),"data-bs-toggle":"modal","data-bs-target":"#viewSettingModal"},x(t.name),9,Nt)])])])])]))),128))])])])):p("",!0),e("div",Ot,[e("div",jt,[e("div",Zt,[e("div",Bt,[At,i.value[0].flag?(o(),$(Ee,{key:0,onGetLoginData:s[0]||(s[0]=t=>n())})):p("",!0),i.value[1].flag||i.value[2].flag||i.value[3].flag?(o(),$(Ze,{key:1,userData:c.value,onGetLoginData:s[1]||(s[1]=t=>n())},null,8,["userData"])):p("",!0)])])])]),e("div",Pt,[e("div",It,[e("div",Vt,[e("div",Ft,[Rt,l.value[0].flag?(o(),$(re,{key:0,email:c.value.email,onGetLoginData:s[2]||(s[2]=t=>n())},null,8,["email"])):p("",!0),l.value[1].flag?(o(),$(Me,{key:1,email:c.value.email,onGetLoginData:s[3]||(s[3]=t=>n())},null,8,["email"])):p("",!0),l.value[2].flag?(o(),$(Ye,{key:2,userLoginData:c.value},null,8,["userLoginData"])):p("",!0)])])])])],64)}}},Jt=O(Et,[["__scopeId","data-v-132ec8e1"]]);export{Jt as default};
